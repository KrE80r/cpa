(()=>{var L=Object.defineProperty;var _=(o,t,e)=>t in o?L(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var h=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports);var p=(o,t,e)=>(_(o,typeof t!="symbol"?t+"":t,e),e);var v=h(g=>{var y={ItemsList_Kette:"Store Chain",ItemsList_Name:"Name",ItemsList_Preis:"Price",ItemsList_Aktionen:"Actions","ItemsList_Preis aufsteigend":"Price ascending","ItemsList_Preis absteigend":"Price descending","ItemsList_Kette &amp; Name":"Store &amp; Name",ItemsList_Sortieren:"Sort by",ItemsList_Namens\u00E4hnlichkeit:"Name similarity","ItemsList_Menge aufsteigend":"Quantity ascending","ItemsList_Menge absteigend":"Quantity descending",ItemsList_Resultate:"Results",ItemsList_Diagramm:"Chart",ItemsList_Verkaufspreis:"Unit price",ItemsList_Mengenpreis:"Bulk price",ItemsFilter_Product_Search:"Product search...",ItemsFilter_Toggle_Filters:"Show/hide filters",ItemsFilter_All:"All",ItemsFilter_Date:"Date",ItemsFilter_Cheaper_Since_Last_Change:"Cheaper since last change",ItemsFilter_Discount_Store_Brands:"Discount store brands only",ItemsFilter_Organic_Only:"Only organic",ItemsFilter_Exact_Word:"Exact word",ItemsFilter_Price:"Price A$",ItemsFilter_More_Expensive:"More expensive",ItemsFilter_Cheaper:"Cheaper",ItemsFilter_Min_Characters:"(min. 3 characters)","ItemsFilter_Preis $":"Price $","ItemsFilter_Exaktes Wort":"Exact word","ItemsFilter_Nur Bio":"Bio only","ItemsChart_Preissumme Gesamt":"Total price sum","ItemsChart_Preissumme Ketten":"Store price sums","ItemsChart_Nur heutige Preise":"Today's prices only","ItemsChart_Preissumme {{s}}":"Price sum {{s}}","ItemsChart_Keine Daten ausgew\xE4hlt":"No data selected",CartsList_Name:"Name",CartsList_Produkte:"Products",CartsList_Preis:"Price",CartsList_Preis\u00E4nderungen:"Price",CartsList_Teilen:"Share","Settings_Vorselektierte Ketten":"Preselected stores",alternative:"alternative",alternatives:"alternatives"};function w(o,t={}){let e=y[o]||o;if(t&&typeof t=="object")for(let[i,r]of Object.entries(t))e=e.replace(new RegExp(`{{${i}}}`,"g"),r);return e}g.__=w});var S=h((k,I)=>{var{__:a}=v(),c=class{static validate(t){if(!t.version)return{valid:!1,error:"Missing version field"};if(t.version!=="1.0")return{valid:!1,error:`Unsupported version: ${t.version}`};if(!t.list||typeof t.list!="object")return{valid:!1,error:"Missing or invalid list data"};let e=t.list;if(!e.name||typeof e.name!="string")return{valid:!1,error:"Missing or invalid list name"};if(!Array.isArray(e.stores))return{valid:!1,error:"Missing or invalid stores array"};if(!Array.isArray(e.items))return{valid:!1,error:"Missing or invalid items array"};for(let i of e.stores)if(!this.VALID_STORES.includes(i))return{valid:!1,error:`Invalid store name: ${i}`};for(let i=0;i<e.items.length;i++){let r=e.items[i];if(!r.mainRef||typeof r.mainRef!="object")return{valid:!1,error:`Item ${i}: missing mainRef`};if(!r.mainRef.store||!r.mainRef.id)return{valid:!1,error:`Item ${i}: invalid mainRef structure`};if(!this.VALID_STORES.includes(r.mainRef.store))return{valid:!1,error:`Item ${i}: invalid store in mainRef: ${r.mainRef.store}`};if(!Array.isArray(r.alternativeRefs))return{valid:!1,error:`Item ${i}: invalid alternativeRefs`};for(let s=0;s<r.alternativeRefs.length;s++){let n=r.alternativeRefs[s];if(!n.store||!n.id)return{valid:!1,error:`Item ${i}, alt ${s}: invalid reference structure`};if(!this.VALID_STORES.includes(n.store))return{valid:!1,error:`Item ${i}, alt ${s}: invalid store: ${n.store}`};if(n.quantity!==void 0&&(typeof n.quantity!="number"||n.quantity<=0))return{valid:!1,error:`Item ${i}, alt ${s}: quantity must be a positive number`}}if(r.selected&&!["main","alt"].includes(r.selected))return{valid:!1,error:`Item ${i}: invalid selected value: ${r.selected}`}}return e.createdAt&&isNaN(Date.parse(e.createdAt))?{valid:!1,error:"Invalid createdAt timestamp"}:e.updatedAt&&isNaN(Date.parse(e.updatedAt))?{valid:!1,error:"Invalid updatedAt timestamp"}:{valid:!0}}};p(c,"VALID_STORES",["aldi","coles","woolies","iga"]);var m=class{constructor(){this.lists=[],this.init()}init(){this.loadLists(),this.setupEventListeners(),this.render()}loadLists(){this.lists=[];for(let t=0;t<localStorage.length;t++){let e=localStorage.key(t);if(e&&e.startsWith("shopping_list_"))try{let i=JSON.parse(localStorage.getItem(e));this.lists.push(i)}catch(i){console.error(`Failed to load list ${e}:`,i)}}this.lists.sort((t,e)=>new Date(e.createdAt)-new Date(t.createdAt))}setupEventListeners(){let t=document.getElementById("newListBtn"),e=document.getElementById("createFirstBtn"),i=document.getElementById("importHeaderBtn"),r=document.getElementById("importFirstBtn"),s=document.getElementById("import-file-input"),n=document.getElementById("cancelBtn"),l=document.getElementById("createBtn"),u=document.getElementById("newListModal"),f=document.getElementById("listNameInput");t&&t.addEventListener("click",()=>this.showNewListModal()),e&&e.addEventListener("click",()=>this.showNewListModal()),i&&i.addEventListener("click",()=>this.triggerImport()),r&&r.addEventListener("click",()=>this.triggerImport()),s&&s.addEventListener("change",d=>this.handleImportFile(d)),n&&n.addEventListener("click",()=>this.hideNewListModal()),l&&l.addEventListener("click",()=>this.createList()),u&&u.addEventListener("click",d=>{d.target.id==="newListModal"&&this.hideNewListModal()}),f&&f.addEventListener("keypress",d=>{d.key==="Enter"&&this.createList()})}showNewListModal(){let t=document.getElementById("newListModal"),e=document.getElementById("listNameInput");!t||!e||(t.classList.remove("hidden"),e.value="",document.querySelectorAll(".store-checkbox").forEach(i=>i.checked=!1),setTimeout(()=>e.focus(),100))}hideNewListModal(){let t=document.getElementById("newListModal");t&&t.classList.add("hidden")}createList(){let e=document.getElementById("listNameInput").value.trim();if(!e){alert(a("Please enter a list name"));return}let i=Array.from(document.querySelectorAll(".store-checkbox:checked")).map(n=>n.value);if(i.length===0){alert(a("Please select at least one store"));return}let r="sl_"+Date.now(),s={id:r,name:e,stores:i,items:[],createdAt:new Date().toISOString()};localStorage.setItem(`shopping_list_${r}`,JSON.stringify(s)),this.loadLists(),this.render(),this.hideNewListModal(),window.location.href=`shopping-list-detail.html?id=${r}`}deleteList(t){confirm(a("Delete this list?"))&&(localStorage.removeItem(`shopping_list_${t}`),this.loadLists(),this.render())}render(){let t=document.getElementById("listsContainer"),e=document.getElementById("emptyState");if(!(!t||!e)){if(this.lists.length===0){t.innerHTML="",e.classList.remove("hidden");return}e.classList.add("hidden"),t.innerHTML=this.lists.map(i=>{let r=i.items?i.items.length:0,s=i.stores.map(l=>({woolies:"Woolworths",coles:"Coles",aldi:"ALDI",iga:"IGA"})[l]||l).join(", "),n=new Date(i.createdAt).toLocaleDateString();return`
                <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between">
                        <div class="flex-1 cursor-pointer" onclick="window.location.href='shopping-list-detail.html?id=${i.id}'">
                            <h3 class="text-lg font-semibold mb-1">${this.escapeHtml(i.name)}</h3>
                            <div class="text-sm text-gray-600 space-y-1">
                                <div>\u{1F4E6} ${r} ${a(r===1?"item":"items")}</div>
                                <div>\u{1F3EA} ${s}</div>
                                <div>\u{1F4C5} ${n}</div>
                            </div>
                        </div>
                        <div class="flex gap-2 ml-4">
                            <button onclick="window.location.href='shopping-list-detail.html?id=${i.id}'"
                                    class="px-3 py-2 text-primary hover:bg-primary/10 rounded-lg transition-colors min-h-[44px]"
                                    title="${a("View list")}">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                </svg>
                            </button>
                            <button onclick="shoppingListsManager.deleteList('${i.id}')"
                                    class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors min-h-[44px]"
                                    title="${a("Delete list")}">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `}).join("")}}triggerImport(){document.getElementById("import-file-input").click()}handleImportFile(t){let e=t.target.files[0];if(!e)return;if(!e.name.endsWith(".json")){alert(a("Please select a JSON file")),t.target.value="";return}let i=new FileReader;i.onload=r=>{try{let s=r.target.result;this.importList(s)}catch(s){console.error("File read failed:",s),alert(a("Failed to read file"))}finally{t.target.value=""}},i.onerror=()=>{alert(a("Failed to read file")),t.target.value=""},i.readAsText(e)}importList(t){try{let e;try{e=JSON.parse(t)}catch{alert(a("Invalid JSON format"));return}let i=c.validate(e);if(!i.valid){alert(a(i.error)),console.error("Validation failed:",i.error);return}let r=a(`Import "${e.list.name}" as a new list?`);if(!confirm(r))return;let s="sl_"+Date.now(),n={id:s,name:e.list.name,stores:e.list.stores,items:e.list.items,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{localStorage.setItem(`shopping_list_${s}`,JSON.stringify(n))}catch(l){if(l.name==="QuotaExceededError"){alert(a("Storage full! Please delete old lists to make space."));return}throw l}console.log(`Created new list from import: ${n.name} (${n.items.length} items)`),window.location.href=`shopping-list-detail.html?id=${s}`}catch(e){console.error("Import failed:",e),alert(a("Failed to import list"))}}escapeHtml(t){let e=document.createElement("div");return e.textContent=t,e.innerHTML}};window.shoppingListsManager=new m;I.exports={ShoppingListsManager:m,ImportValidator:c}});S();})();
//# sourceMappingURL=shopping-list.js.map
